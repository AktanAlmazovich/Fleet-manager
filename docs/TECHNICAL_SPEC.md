# Техническое задание

## Система управления автопарком "FleetPro"

**Версия:** 1.0  
**Дата:** Декабрь 2024  
**Автор:** [ФИО студента]

---

## 1. Введение

### 1.1 Назначение проекта
FleetPro — веб-приложение для управления автопарком транспортных компаний. Система обеспечивает учёт транспортных средств, управление водителями, мониторинг местоположения и финансовую аналитику.

### 1.2 Область применения
- Таксопарки
- Службы доставки
- Логистические компании
- Корпоративные автопарки

### 1.3 Термины и определения

| Термин | Определение |
|--------|-------------|
| ТС | Транспортное средство |
| ТО | Техническое обслуживание |
| Рейс | Поездка с назначенным водителем |
| MVP | Minimum Viable Product |
| API | Application Programming Interface |
| CRUD | Create, Read, Update, Delete |

---

## 2. Описание проблемы

### 2.1 Текущая ситуация
Транспортные компании Кыргызстана часто используют бумажный учёт или разрозненные таблицы Excel для управления автопарком, что приводит к:
- Потере информации о статусе автомобилей
- Неэффективному распределению рейсов
- Отсутствию контроля технического состояния
- Сложностям финансового учёта

### 2.2 Целевые пользователи

| Роль | Описание | Потребности |
|------|----------|-------------|
| **Администратор** | Менеджер автопарка | Полный контроль, отчётность, аналитика |
| **Водитель** | Штатный сотрудник | Просмотр своих рейсов и заработка |

---

## 3. Цели и задачи разработки

### 3.1 Бизнес-цели
1. Централизация управления автопарком
2. Повышение эффективности распределения ТС
3. Сокращение времени на административные задачи
4. Прозрачность финансовых показателей

### 3.2 Задачи системы
- Учёт транспортных средств и их статусов
- Управление водителями и назначениями
- Мониторинг местоположения на карте
- Финансовая отчётность
- Планирование техобслуживания

---

## 4. Требования к системе

### 4.1 Функциональные требования

#### FR-001: Аутентификация
| ID | Описание |
|----|----------|
| FR-001.1 | Система должна поддерживать вход по логину/паролю |
| FR-001.2 | Система должна различать роли: admin, driver |
| FR-001.3 | Сессия должна сохраняться в localStorage |

#### FR-002: Управление транспортом
| ID | Описание |
|----|----------|
| FR-002.1 | Отображение списка всех ТС в виде карточек |
| FR-002.2 | Статусы: available, busy, maintenance |
| FR-002.3 | Назначение водителя на рейс |
| FR-002.4 | Завершение рейса с освобождением ТС |
| FR-002.5 | Отправка ТС на техобслуживание |
| FR-002.6 | Отображение пробега и "здоровья" ТС |

#### FR-003: Управление водителями
| ID | Описание |
|----|----------|
| FR-003.1 | Список водителей с рейтингом и статистикой |
| FR-003.2 | Детальная карточка с историей рейсов |
| FR-003.3 | Диаграмма навыков (radar chart) |

#### FR-004: Карта
| ID | Описание |
|----|----------|
| FR-004.1 | Отображение карты Бишкека (OpenStreetMap) |
| FR-004.2 | Маркеры ТС с цветовой индикацией статуса |
| FR-004.3 | Popup с информацией при клике на маркер |

#### FR-005: Финансовая аналитика
| ID | Описание |
|----|----------|
| FR-005.1 | Сводка: доходы, расходы, прибыль |
| FR-005.2 | Диаграмма распределения статусов |
| FR-005.3 | График расходов на топливо |
| FR-005.4 | Таблица последних транзакций |

#### FR-006: Уведомления
| ID | Описание |
|----|----------|
| FR-006.1 | Центр уведомлений с колокольчиком |
| FR-006.2 | Типы: warning, danger, success, info |
| FR-006.3 | Отметка прочтения |

### 4.2 Нефункциональные требования

#### NFR-001: Производительность
- Время загрузки страницы: < 3 секунды
- Время отклика API: < 500 мс
- Поддержка до 100 ТС в базе

#### NFR-002: Безопасность
- Хранение паролей (в MVP — plain text, в production — bcrypt)
- Проверка авторизации на каждом эндпоинте
- CORS-защита API

#### NFR-003: Надёжность
- Обработка ошибок на клиенте и сервере
- Graceful degradation при отсутствии данных

#### NFR-004: UX/UI
- Responsive дизайн (desktop-first)
- Dark/Light режим
- Skeleton loading
- Анимации переходов

#### NFR-005: Совместимость
- Браузеры: Chrome, Firefox, Edge (последние версии)
- Экраны: 1280px+

### 4.3 Ограничения

| Категория | Ограничение |
|-----------|-------------|
| Frontend | React 18, Vite, Tailwind CSS |
| Backend | Node.js, Express.js |
| База данных | SQLite (локальная) |
| Карты | Leaflet + OpenStreetMap |
| Деплой | Локальный запуск (MVP) |

---

## 5. Требования к архитектуре

### 5.1 Целевая архитектура
**Client-Server (REST API)**

```
┌──────────────────────────────────────────────────────────────┐
│                        КЛИЕНТ (React)                        │
├──────────────────────────────────────────────────────────────┤
│  Components  │  Context (Auth, Theme, Notification)  │ Pages │
└──────────────────────────┬───────────────────────────────────┘
                           │ HTTP/REST
                           ▼
┌──────────────────────────────────────────────────────────────┐
│                      СЕРВЕР (Express)                        │
├──────────────────────────────────────────────────────────────┤
│         Routes         │       Controllers       │   CORS    │
└──────────────────────────┬───────────────────────────────────┘
                           │ SQL
                           ▼
┌──────────────────────────────────────────────────────────────┐
│                      БАЗА ДАННЫХ (SQLite)                    │
├──────────────────────────────────────────────────────────────┤
│   users   │   vehicles   │   drivers   │   trips   │  logs   │
└──────────────────────────────────────────────────────────────┘
```

### 5.2 Компоненты клиентской части

| Компонент | Назначение |
|-----------|------------|
| App.jsx | Корневой компонент, роутинг |
| AuthContext | Управление сессией |
| ThemeContext | Dark/Light режим |
| NotificationContext | Уведомления |
| Sidebar | Навигация |
| VehicleCard | Карточка ТС |
| MapView | Интерактивная карта |
| DriversPage | Управление водителями |
| FinancePage | Финансовая аналитика |

### 5.3 Компоненты серверной части

| Endpoint | Метод | Описание |
|----------|-------|----------|
| /api/auth/login | POST | Аутентификация |
| /api/vehicles | GET | Список ТС |
| /api/vehicles/:id/status | POST | Обновление статуса |
| /api/drivers | GET | Список водителей |
| /api/drivers/:id | GET | Детали водителя |
| /api/trips | GET | Все рейсы |

---

## 6. Требования к базе данных

### 6.1 СУБД
**SQLite 3** — встроенная реляционная БД

### 6.2 ER-диаграмма

```
┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│   users     │       │   drivers   │       │  vehicles   │
├─────────────┤       ├─────────────┤       ├─────────────┤
│ id (PK)     │       │ id (PK)     │◄──────│ driverId(FK)│
│ username    │       │ name        │       │ id (PK)     │
│ password    │       │ phone       │       │ name        │
│ role        │       │ email       │       │ plate       │
│ driverId(FK)│──────►│ avatar      │       │ status      │
└─────────────┘       │ rating      │       │ latitude    │
                      │ totalTrips  │       │ longitude   │
                      │ totalEarnings│      │ mileage     │
                      │ status      │       │ image       │
                      └──────┬──────┘       └─────────────┘
                             │
                             │
                      ┌──────▼──────┐
                      │    trips    │
                      ├─────────────┤
                      │ id (PK)     │
                      │ vehicleId(FK)
                      │ driverId(FK)│
                      │ startDate   │
                      │ endDate     │
                      │ earnings    │
                      │ distance    │
                      └─────────────┘
```

### 6.3 Требования к хранению
- Локальный файл `fleet.db`
- Автоматическое создание при инициализации
- Seed-данные для демонстрации

---

## 7. Требования к интерфейсу

### 7.1 Основные экраны

| Экран | Описание | Доступ |
|-------|----------|--------|
| Логин | Форма входа | Все |
| Обзор | Статистика + приветствие | Admin |
| Автопарк | Карточки ТС | Admin |
| Карта | Маркеры на карте Бишкека | Admin |
| Финансы | Графики и таблицы | Admin |
| Водители | Список + детали | Admin |
| Личный кабинет | Статистика водителя | Driver |

### 7.2 Пользовательские роли

| Роль | Доступ |
|------|--------|
| admin | Все разделы, все действия |
| driver | Только личный кабинет |

---

## 8. Требования к тестированию

### 8.1 Виды тестов

| Тип | Описание | Статус |
|-----|----------|--------|
| Ручное тестирование | Проверка UI и бизнес-логики | ✅ Выполнено |
| API тестирование | Postman/curl | ✅ Рекомендуется |
| Unit-тесты | Jest (опционально) | ⏳ Планируется |

### 8.2 Критерии приёмки

| ID | Критерий |
|----|----------|
| AC-001 | Пользователь может войти с корректными данными |
| AC-002 | Список ТС отображается корректно |
| AC-003 | Статус ТС обновляется при действиях |
| AC-004 | Карта отображает маркеры машин |
| AC-005 | Dark Mode переключается и сохраняется |

---

## 9. Требования к развёртыванию

### 9.1 Окружение
- Node.js 18+
- npm 9+
- Любая ОС (Windows, macOS, Linux)

### 9.2 Инструкция по установке

```bash
# Backend
cd server && npm install && node setupDb.js

# Frontend
cd client_new && npm install

# Запуск
# Terminal 1: cd server && node server.js
# Terminal 2: cd client_new && npm run dev
```

### 9.3 Порты
- Backend: `http://localhost:3000`
- Frontend: `http://localhost:5173`

---

## 10. Критерии готовности MVP

### 10.1 Обязательные функции

| # | Функция | Статус |
|---|---------|--------|
| 1 | Аутентификация (admin/driver) | ✅ |
| 2 | Просмотр списка ТС | ✅ |
| 3 | Назначение/завершение рейса | ✅ |
| 4 | Отправка на ТО | ✅ |
| 5 | Список водителей | ✅ |
| 6 | Карта с маркерами | ✅ |
| 7 | Финансовая аналитика | ✅ |
| 8 | Dark Mode | ✅ |
| 9 | Центр уведомлений | ✅ |
| 10 | Личный кабинет водителя | ✅ |

### 10.2 Статус: **MVP ГОТОВ** ✅

---

## Приложение А: Use Cases

### UC-001: Назначение рейса
**Актор:** Администратор  
**Предусловие:** ТС в статусе "available"  
**Шаги:**
1. Админ нажимает "Назначить рейс" на карточке ТС
2. Система открывает модальное окно
3. Админ вводит имя водителя
4. Админ нажимает "Назначить"
5. Система обновляет статус ТС на "busy"
6. Система показывает toast-уведомление

**Постусловие:** ТС в статусе "busy" с назначенным водителем

---

## Приложение Б: Словарь данных

| Сущность | Атрибут | Тип | Описание |
|----------|---------|-----|----------|
| Vehicle | id | INTEGER | Уникальный идентификатор |
| Vehicle | name | TEXT | Марка и модель |
| Vehicle | plate | TEXT | Гос. номер (формат KG) |
| Vehicle | status | TEXT | available/busy/maintenance |
| Vehicle | mileage | INTEGER | Пробег в км |
| Driver | rating | REAL | Рейтинг 0.0-5.0 |
| Driver | totalEarnings | REAL | Сумма в сомах |
